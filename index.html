<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>忘年会クイズ2024 – ページ構成版</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Hiragino Kaku Gothic ProN', 'メイリオ', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 30px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        /* 各ページは page クラスで管理し、active の付いたものだけ表示 */
        .page {
            display: none;
        }
        .page.active {
            display: block;
        }

        /* チーム選択ページ用スタイル */
        .team-page {
            text-align: center;
        }
        .team-page h1 {
            font-size: 48px;
            color: #667eea;
            margin-bottom: 20px;
        }
        .team-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }
        .team-button {
            padding: 20px;
            font-size: 22px;
            font-weight: bold;
            border: none;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            color: white;
        }
        .team-button:nth-child(1) { background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); }
        .team-button:nth-child(2) { background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); }
        .team-button:nth-child(3) { background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); }
        .team-button:nth-child(4) { background: linear-gradient(135deg, #fa709a 0%, #fee140 100%); }
        .team-button:nth-child(5) { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .team-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        /* 問題ページと回答ページの共通スタイル */
        .quiz-page, .answer-page {
            margin-top: 40px;
        }
        .question-title {
            font-size: 32px;
            color: #333;
            margin-bottom: 20px;
            font-weight: bold;
        }
        .question-text {
            font-size: 26px;
            margin-bottom: 25px;
            white-space: pre-line;
        }
        .options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }
        .option-box {
            background: #fff;
            border: 4px solid #e0e0e0;
            border-radius: 20px;
            padding: 20px;
            font-size: 20px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 15px;
            min-height: 80px;
            transition: all 0.3s ease;
        }
        .option-box:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.2);
            border-color: #4facfe;
        }
        .option-box.selected {
            border-color: #4facfe;
            background: #e3f5ff;
        }
        .option-label {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            font-weight: bold;
            color: #fff;
            flex-shrink: 0;
        }
        .option-a .option-label { background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); }
        .option-b .option-label { background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); }
        .option-c .option-label { background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); }
        .option-d .option-label { background: linear-gradient(135deg, #fa709a 0%, #fee140 100%); }

        .action-button {
            margin-top: 30px;
            padding: 15px 40px;
            font-size: 22px;
            font-weight: bold;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 40px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .action-button:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
        }
        .action-button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .answer-content {
            font-size: 24px;
            line-height: 1.6;
        }

        .final-page {
            text-align: center;
            padding: 60px 20px;
        }
        .final-page h1 {
            font-size: 48px;
            color: #667eea;
            margin-bottom: 20px;
        }
        .final-page p {
            font-size: 24px;
            margin-bottom: 30px;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- 班選択ページ -->
        <div id="teamPage" class="page team-page active">
            <h1>🎉 忘年会クイズ 2024 🎉</h1>
            <p style="font-size: 22px; color: #666;">班を選択してください</p>
            <div class="team-buttons">
                <button class="team-button" onclick="startQuiz(1)">1班</button>
                <button class="team-button" onclick="startQuiz(2)">2班</button>
                <button class="team-button" onclick="startQuiz(3)">3班</button>
                <button class="team-button" onclick="startQuiz(4)">4班</button>
                <button class="team-button" onclick="startQuiz(5)">5班</button>
            </div>
        </div>

        <!-- 問題ページ -->
        <div id="quizPage" class="page quiz-page">
            <div class="question-title" id="quizTitle"></div>
            <div class="question-text" id="quizQuestion"></div>
            <div class="options" id="optionsContainer"></div>
            <button class="action-button" id="submitAnswerBtn" onclick="submitAnswer()" disabled>回答を見る</button>
        </div>

        <!-- 回答ページ -->
        <div id="answerPage" class="page answer-page">
            <div class="question-title" id="answerTitle"></div>
            <div class="answer-content" id="answerContent"></div>
            <button class="action-button" id="nextQuizBtn" onclick="goToNextQuestion()">次のクイズへ</button>
        </div>

        <!-- 最終ページ -->
        <div id="finalPage" class="page final-page">
            <h1>🎊 お疲れ様でした！ 🎊</h1>
            <p id="finalMessage">全ての回答が送信されました。</p>
            <button class="action-button" onclick="location.reload()">最初に戻る</button>
        </div>
    </div>

    <script>
        // クイズデータ
        const quizData = [
            {
                title: '第1問',
                question: '学生時代、実は〇〇でした！\n組み合わせを正解せよ',
                options: [
                    '城井×坊主',
                    '岩崎×体育会の部活で宴会隊長',
                    '石田×勉強部',
                    '前川×体力テストで学年2位'
                ],
                answerInfo: '城井×坊主 / 岩崎×体育会の部活で宴会隊長 / 石田×勉強部 / 前川×体力テストで学年2位'
            },
            {
                title: '第2問',
                question: 'まだ誰にも教えたことのない趣味は？',
                options: [
                    '毎田×(母と一緒に)ハガキ職人',
                    '河村×兄のSNSを監視すること',
                    '山本×インスタに出てくる女性向け恋愛小説を読む',
                    '吉田×大きめの公園で、子どもがサッカーするのを見る'
                ],
                answerInfo: '毎田×ハガキ職人 / 河村×兄のSNSを監視すること / 山本×女性向け恋愛小説を読む / 吉田×公園で子どもがサッカーするのを見る'
            },
            {
                title: '第3問',
                question: '富樫さんが過去の恋愛にまつわる\n「今だから言える話」は？',
                options: [
                    '大学のオープンキャンパスで好きな人を誘っていた',
                    '大学院生時代に付き合っていた彼女に監禁されていた',
                    '大学デビューで4月にタイプの女性2人とデートに行った',
                    '最近一番最初に付き合った彼女に結婚を迫られている'
                ],
                answerInfo: '正解: オプション4'
            },
            {
                title: '第4問',
                question: '岩崎さんの仕事のこだわりは？',
                options: [
                    '電話の時に必要以上に声色を上げている',
                    'イスは一番高いところまで上げて座る',
                    '若干遅れ目にMeetに入る',
                    'これでいこう！と思ったことを一晩寝かせて、翌日も良いものと思えれば採用する'
                ],
                answerInfo: '正解は準備中です'
            },
            {
                title: '第5問',
                question: '城井さん最近一番ブチギレた\nエピソードは？',
                options: [
                    '大塚さんとフェス(11:00開始)に行く約束してたのに寝坊して18:30に来た',
                    '車から家へ運ぶ荷物の割合で妻にキレられたこと',
                    'アイアンがうまく当たらなくてキレ散らかしてます(ゴルフの話)',
                    '怒ったことない みんなたいせつ しあわせ'
                ],
                answerInfo: '正解は準備中です'
            },
            {
                title: '第6問',
                question: 'えりちょすこと吉川枝里の\n学生時代、実は〇〇でした〜〜',
                options: [
                    '大食いだった',
                    '寝坊ばかりで進級が危なかった',
                    'インコを飼っていた',
                    '飲み比べで女性に負けたことがなかった'
                ],
                answerInfo: '正解は準備中です'
            },
            {
                title: '第7問',
                question: 'とっしーこと平井壽希が\nガチで本物と間違えられた芸能人は？',
                options: [
                    '平野紫耀(元キンプリ)',
                    '吉村崇(平成ノブシコブシ)',
                    '白濱亜嵐(GENERATIONS)',
                    'その他'
                ],
                answerInfo: '正解は準備中です'
            },
            {
                title: '第8問',
                question: 'なもさんこと名本佳央が\n放ったひとこと',
                options: [
                    '可愛くても',
                    '金持ちでも',
                    '慶應出ててても',
                    'TWICEのミナでも'
                ],
                answerInfo: '正解は準備中です'
            },
            {
                title: '第9問',
                question: 'カザフこと赤坂幸亮が\nダーツサークルの部長に立候補した理由',
                options: [
                    '前日の飲みで負けたから',
                    '人の上に立ち支配してみたかったから',
                    'ガクチカに使えると思ったから',
                    '可愛い子しか入サーさせたくなかったから'
                ],
                answerInfo: '正解は準備中です'
            }
        ];

        let currentTeam = null;
        let currentIndex = 0;
        let selectedAnswerIndex = null;

        // 班選択後にクイズを開始
        function startQuiz(teamNumber) {
            currentTeam = teamNumber;
            currentIndex = 0;
            selectedAnswerIndex = null;
            // チームページを隠して最初の質問へ
            document.getElementById('teamPage').classList.remove('active');
            showQuestionPage();
        }

        // 質問ページを表示
        function showQuestionPage() {
            const submitBtn = document.getElementById('submitAnswerBtn');
            submitBtn.disabled = true;
            // 画面切り替え
            document.getElementById('answerPage').classList.remove('active');
            document.getElementById('finalPage').classList.remove('active');
            document.getElementById('quizPage').classList.add('active');
            // 内容設定
            const data = quizData[currentIndex];
            document.getElementById('quizTitle').textContent = data.title;
            document.getElementById('quizQuestion').textContent = data.question;
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            const labels = ['A','B','C','D'];
            data.options.forEach((opt, idx) => {
                const div = document.createElement('div');
                div.className = `option-box option-${labels[idx].toLowerCase()}`;
                div.innerHTML = `<div class="option-label">${labels[idx]}</div><div>${opt}</div>`;
                div.onclick = () => selectOption(idx, div);
                optionsContainer.appendChild(div);
            });
        }

        function selectOption(index, element) {
            document.querySelectorAll('.option-box').forEach(box => box.classList.remove('selected'));
            element.classList.add('selected');
            selectedAnswerIndex = index;
            document.getElementById('submitAnswerBtn').disabled = false;
        }

        // 回答を見る（回答ページへ遷移）
        function submitAnswer() {
            if (selectedAnswerIndex === null) return;
            // 回答をシートへ送信
            sendAnswerToSheet(currentIndex, selectedAnswerIndex);
            // 回答ページに内容設定
            const data = quizData[currentIndex];
            document.getElementById('answerTitle').textContent = data.title + ' の回答';
            const labels = ['A','B','C','D'];
            const chosenLabel = labels[selectedAnswerIndex];
            let info = '';
            info += `<p><strong>あなたの回答:</strong> ${chosenLabel} - ${data.options[selectedAnswerIndex]}</p>`;
            info += `<p><strong>正解情報:</strong> ${data.answerInfo}</p>`;
            document.getElementById('answerContent').innerHTML = info;
            // 画面切り替え
            document.getElementById('quizPage').classList.remove('active');
            document.getElementById('answerPage').classList.add('active');
        }

        // 次の質問へ
        function goToNextQuestion() {
            selectedAnswerIndex = null;
            currentIndex++;
            if (currentIndex < quizData.length) {
                showQuestionPage();
            } else {
                // 最終ページ
                document.getElementById('answerPage').classList.remove('active');
                document.getElementById('finalPage').classList.add('active');
                document.getElementById('finalMessage').textContent = `${currentTeam}班の全回答を送信しました！`;
            }
        }

        /**
         * 回答データをスプレッドシートへ送信
         */
        function sendAnswerToSheet(questionIndex, answerIndex) {
            const GAS_URL = 'https://script.google.com/macros/s/AKfycbzgb3M1GQImh1iVKS9tytj-L6RaaGR-_wmR9bbyogEi15rfFGOsafjHeV3e1iD51MvE/exec';
            const labels = ['A','B','C','D'];
            const answerData = {
                team: currentTeam,
                questionNumber: questionIndex + 1,
                answer: labels[answerIndex],
                timestamp: new Date().toISOString()
            };
            const allResults = JSON.parse(localStorage.getItem('quizResults') || '[]');
            allResults.push(answerData);
            localStorage.setItem('quizResults', JSON.stringify(allResults));
            // iframe + form でPOST
            const iframe = document.createElement('iframe');
            iframe.style.display = 'none';
            iframe.name = 'hidden_iframe_' + Date.now();
            document.body.appendChild(iframe);
            const form = document.createElement('form');
            form.method = 'POST';
            form.action = GAS_URL;
            form.target = iframe.name;
            const input = document.createElement('input');
            input.type = 'hidden';
            input.name = 'data';
            input.value = JSON.stringify(answerData);
            form.appendChild(input);
            document.body.appendChild(form);
            form.submit();
            console.log(`✓ ${currentTeam}班 Q${questionIndex + 1} の回答(${labels[answerIndex]})を送信しました`);
            // 後片付け
            setTimeout(() => {
                if (document.body.contains(form)) document.body.removeChild(form);
                if (document.body.contains(iframe)) document.body.removeChild(iframe);
            }, 2000);
        }
    </script>
</body>
</html>
